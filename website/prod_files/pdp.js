!function(){function t(){e.isSizeAdvisor=!e.isABCTestEnabled()||e.getABCTestFunnel()===e.funnels.sizeAdvisor;var t=document.createElement("script");t.setAttribute("src","//widget.fitanalytics.com/"+(e.isSizeAdvisor?"widget":"metrics")+".js"),t.setAttribute("type","text/javascript"),document.body.appendChild(t),e.initialize(),window._fitAnalytics=window._upcload=function(){},window._fitAnalytics.shop=e}if(!window._fitAnalytics){var e={prefix:"mango-",rawSerials:[],serials:[],products:{},isMobile:/iphone|android|iemobile|blackberry/i.test(window.navigator.userAgent)&&("mozInnerScreenX"in window?"onorientationchange"in window&&"ontouchstart"in window:"ontouchstart"in window),el:{productContainer:"main.product-detail",colorIds:".product-colors-color > .product-colors-color-container",currentColorId:"input#id_colorId_hidden",sizeSelect:".selector_tallas",sizes:'select[id="productFormSelect"] option',sizeDefault:'[value="-1"]',addToCart:"button#productFormAdd",thumbnail:".product-images .main-img > img, .product-images .product-img-container.swiper-slide-active img",sizeChart:"#productFormSizesGuide",buttonClass:"fitanalytics__button"},funnels:{sizeChart:0,sizeAdvisor:1},isSizeAdvisor:!1,hideSizeChart:!0,isABCTestEnabled:function(){return!1},getABCTestFunnel:function(){return window._fitAnalyticsABTestFunnel},initialize:function(){var t=setInterval(function(){e.isLoaded()&&(clearInterval(t),e.onLoaded())},100)},isLoaded:function(){return"function"==typeof window.$&&e.isSizeAdvisor?"function"==typeof window.FitAnalyticsWidget:"function"==typeof window.FitAnalyticsMetrics},onLoaded:function(){e.$=window.$,e.isDataAvailable(e.onPageLoaded)},timer:function(t,e){var n,i=0,o=e||10,r=t||100,a=function(t){return function(){i>=o?clearInterval(n):(i+=1,t())}};return{start:function(t){n=setInterval(a(t),r)},stop:function(){clearInterval(n)}}},isDataAvailable:function(t){var n=e.timer();n.start(function(){var i=e.getCurrentSerial(),o=e.getSerials();i&&o.length&&(n.stop(),t())})},find:function(t){return e.getContainer().find(t)},getContainer:function(){return e.$(e.el.productContainer)},getCurrentStyleId:function(){var t=(t=window.dataLayerV2Json)&&(t=t.ecommerce)&&(t=t.detail)&&(t=t.products)&&t.id;return t},getCurrentColorId:function(){return e.find(e.el.colorIds).filter(".product-colors-color-container--selected").first().attr("id")},getColorIds:function(){return e.find(e.el.colorIds)},getRawSerials:function(){var t=e.getCurrentStyleId();return e.getColorIds().toArray().map(function(n){var i=e.$(n),o=i.attr("id");return t&&o&&t+"_"+o})},getSerials:function(){return e.getRawSerials().map(function(t){return e.prefix+t})},getCurrentRawSerial:function(){var t=e.getCurrentStyleId(),n=e.getCurrentColorId();return t&&n&&t+"_"+n},getCurrentSerial:function(){var t=e.getCurrentRawSerial();return t&&e.prefix+t},urlToRawSerial:function(t){t=t||"";var e=(t.split("/").pop()||"").split("-").slice(1,3);return 2===e.length?e.join("_"):""},getSizes:function(){var t=[];return t.dic={},t.state={},e.find(e.el.sizes).not(e.el.sizeDefault).map(function(){var n=e.$(this),o=i(""+n.data("text")),r="true"===n.attr("data-available");t.state[o]=r,r&&!t.dic[o]&&(t.push(o),t.dic[o]=n)}),t},getLanguage:function(){return e.$("html").attr("lang")},getUserLanguage:function(){var t=e.getLanguage();return"ca"===t?"es":t},getCountry:function(){return window.shopJson&&window.shopJson.country&&window.shopJson.country.iso2},getThumbnail:function(){var t=e.el.thumbnail;return e.find(t).attr("src")},getUserId:function(){var t=window.dataLayerV2Json&&window.dataLayerV2Json.user;return t&&t.logged&&null!==t.userID?t.userID:""},getSizeChart:function(){return e.find(e.el.sizeChart).not("."+e.el.buttonClass)},getRootDomain:function(t){var e=/mango(outlet)?\.[a-z\.]+$/.exec(t);return null!=e?e[0]:null},getContext:function(t){return e.products[t]},setContext:function(t,n){return e.products[t]=e.$.extend(e.products[t],n)},onPageLoaded:function(){e.loadWidget(),e.getSizeChart().on("click.fita",function(){e.widget.meterClick("sizeChart")})},loadWidget:function(){e.widget=new window[e.isSizeAdvisor?"FitAnalyticsWidget":"FitAnalyticsMetrics"]({localCookieDomain:e.getRootDomain(window.location.hostname),language:e.getLanguage(),userLanguage:e.getUserLanguage(),shopCountry:e.getCountry(),userId:e.getUserId(),recommend:function(t,n,i){e.recommend(t,n,i)},cart:function(t,i,o){e.recommend(t,i,o);try{n(e.getSizes().dic[i])}catch(t){}n(e.find(e.el.addToCart)),e.isMobile||e.$("html, #menuContainer, #navTools").removeClass("uclw_widget_open1")},close:function(t,n,i){e.isMobile||e.$("html, #menuContainer, #navTools").removeClass("uclw_widget_open1"),e.recommend(t,n,i)},open:function(){e.isMobile||e.$("html, #menuContainer, #navTools").addClass("uclw_widget_open1"),Object.keys(e.products).forEach(function(t){(e.products[t]||{}).recommendation=null})},load:function(){e.getRecommendation()}}),e.collectProducts();var t=Object.keys(e.products);e.isSizeAdvisor?e.widget.requestProducts(t,function(t){t.forEach(function(t){e.setContext(t.garment.serial,{isSupported:!0})}),e.checkForProductChange()}):e.checkForProductChange()},collectProducts:function(){e.getSerials().forEach(function(t){e.setContext(t,{isSupported:!1})})},recommend:function(t,i,o){var r=e.getSizes().dic[i];n(r)},addRecommendationToContext:function(t,n,i){e.setContext(t,{recommendation:{size:n,details:i}})},checkForProductChange:function(){!function(){var t;setInterval(function(){var n=e.getCurrentSerial();t!==n&&(t=n)&&e.onProductChange()},200)}()},onProductChange:function(){e.reconfigure()},reconfigure:function(){var t=e.getCurrentSerial();t&&e.getContext(t);e.widget.reconfigure({productId:t},e.onProductLoaded,e.onProductLoaded)},onProductLoaded:function(){if(e.isABCTestEnabled())return void e.ABTest.install();var t=e.getContext(e.getCurrentSerial());t&&t.isSupported?e.button.install():e.button.remove()},getRecommendation:function(){e.widget.getRecommendation({productId:e.getCurrentSerial(),thumb:e.getThumbnail(),manufacturedSizes:e.getSizes().state})},button:{find:function(){return e.find("."+e.el.buttonClass)},onClick:function(){return e.widget.open({productId:e.getCurrentSerial(),thumb:e.getThumbnail(),manufacturedSizes:e.getSizes().state}),e.widget.meterClick("sizeAdvisor"),!1},install:function(){this.remove(),e.getSizeChart().off("click.fita").on("click.fita",this.onClick).addClass(e.el.buttonClass)},remove:function(){this.find().off("click.fita").removeClass(e.el.buttonClass).on("click.fita",function(){e.widget.meterClick("sizeChart")})}},ABTest:{$sizeChart:null,$sizeAdvisor:null,install:function(){var t=e.getABCTestFunnel(),n=e.getCurrentSerial(),i=e.getContext(n);e.widget.meterExternalAB(e.getABCTestFunnel());var o={};o[e.funnels.sizeChart]=e.el.sizeChart,o[e.funnels.sizeAdvisor]=e.el.sizeChart,this.$sizeChart=e.$(e.isMobile?e.el.sizeChartMobile:o[t]||""),t===e.funnels.sizeAdvisor&&(e.$(".fitanalytics__button").length||(this.$sizeAdvisor=this.$sizeChart.clone(!0,!0).off().addClass("fitanalytics__button").on("click",e.button.onClick),e.isMobile?this.$sizeAdvisor.find("#sizesInfoTrigger").attr("href",""):this.$sizeAdvisor.attr("onclick",""),this.$sizeChart.after(this.$sizeAdvisor)),this.$sizeChart[i&&i.isSupported?"hide":"show"](),this.$sizeAdvisor[i&&i.isSupported?"show":"hide"]())}}},n=function(t){return!(!t||!e.$)&&(t instanceof e.$||(t=e.$(t)),"function"==typeof t.prop&&"OPTION"===t.prop("tagName")?(t.parent().val(t.val()),t[0].parentElement.dispatchEvent(new Event("change",{bubbles:!0,composed:!0}))):e.isMobile&&"function"==typeof t.tap?t.click():"function"==typeof t.click&&t.click(),t)},i=function(t){return"string"!=typeof t?"":t.replace(/^["'\s\uFEFF\xA0]+|[\s\uFEFF\xA0"']+$/g,"")};"interactive"===document.readyState||"complete"===document.readyState?t():document.addEventListener("DOMContentLoaded",function(){t()})}}();