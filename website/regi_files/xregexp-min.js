var XRegExp;XRegExp=XRegExp||function(J){function C(d,b,c){var a;for(a in E.prototype){E.prototype.hasOwnProperty(a)&&(d[a]=E.prototype[a])}return d.xregexp={captureNames:b,isNative:!!c},d}function O(a){return(a.global?"g":"")+(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.extended?"x":"")+(a.sticky?"y":"")}function I(d,b,a){if(!E.isRegExp(d)){throw new TypeError("type RegExp expected")}var c=M.replace.call(O(d)+(b||""),N,"");return a&&(c=M.replace.call(c,new RegExp("["+a+"]+","g"),"")),d=d.xregexp&&!d.xregexp.isNative?C(E(d.source,c),d.xregexp.captureNames?d.xregexp.captureNames.slice(0):null):C(new RegExp(d.source,c),null,!0)}function V(c,b){var a=c.length;if(Array.prototype.lastIndexOf){return c.lastIndexOf(b)}while(a--){if(c[a]===b){return a}}return -1}function F(b,a){return Object.prototype.toString.call(b).toLowerCase()==="[object "+a+"]"}function R(a){return a=a||{},a==="all"||a.all?a={natives:!0,extensibility:!0}:F(a,"string")&&(a=E.forEach(a,/[^\s,]+/,function(b){this[b]=!0},{})),a}function z(b,p,c,l){var a=H.length,r=null,k,g;A=!0;try{while(a--){if(g=H[a],(g.scope==="all"||g.scope===c)&&(!g.trigger||g.trigger.call(l))&&(g.pattern.lastIndex=p,k=G.exec.call(g.pattern,b),k&&k.index===p)){r={output:g.handler.call(l,k,c),match:k};break}}}catch(d){throw d}finally{A=!1}return r}function U(a){E.addToken=S[a?"on":"off"],P.extensibility=a}function j(a){RegExp.prototype.exec=(a?G:M).exec,RegExp.prototype.test=(a?G:M).test,String.prototype.match=(a?G:M).match,String.prototype.replace=(a?G:M).replace,String.prototype.split=(a?G:M).split,P.natives=a}var E,S,D,P={natives:!1,extensibility:!1},M={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},G={},L={},H=[],Q="default",x="class",q={"default":/^(?:\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9]\d*|x[\dA-Fa-f]{2}|u[\dA-Fa-f]{4}|c[A-Za-z]|[\s\S])|\(\?[:=!]|[?*+]\?|{\d+(?:,\d*)?}\??)/,"class":/^(?:\\(?:[0-3][0-7]{0,2}|[4-7][0-7]?|x[\dA-Fa-f]{2}|u[\dA-Fa-f]{4}|c[A-Za-z]|[\s\S]))/},T=/\$(?:{([\w$]+)}|(\d\d?|[\s\S]))/g,N=/([\s\S])(?=[\s\S]*\1)/g,W=/^(?:[?*+]|{\d+(?:,\d*)?})\??/,m=M.exec.call(/()??/,"")[1]===J,K=RegExp.prototype.sticky!==J,A=!1,B="gim"+(K?"y":"");return E=function(d,o){if(E.isRegExp(d)){if(o!==J){throw new TypeError("can't supply flags when constructing one RegExp from another")}return I(d)}if(A){throw new Error("can't call the XRegExp constructor within token definition functions")}var g=[],n=Q,k={hasNamedCapture:!1,captureNames:[],hasFlag:function(a){return o.indexOf(a)>-1}},h=0,i,t,e;if(d=d===J?"":String(d),o=o===J?"":String(o),M.match.call(o,N)){throw new SyntaxError("invalid duplicate regular expression flag")}for(d=M.replace.call(d,/^\(\?([\w$]+)\)/,function(b,a){if(M.test.call(/[gy]/,a)){throw new SyntaxError("can't use flag g or y in mode modifier")}return o=M.replace.call(o+a,N,""),""}),E.forEach(o,/[\s\S]/,function(a){if(B.indexOf(a[0])<0){throw new SyntaxError("invalid regular expression flag "+a[0])}});h<d.length;){i=z(d,h,n,k),i?(g.push(i.output),h+=i.match[0].length||1):(t=M.exec.call(q[n],d.slice(h)),t?(g.push(t[0]),h+=t[0].length):(e=d.charAt(h),e==="["?n=x:e==="]"&&(n=Q),g.push(e),++h))}return C(new RegExp(g.join(""),M.replace.call(o,/[^gimy]+/g,"")),k.hasNamedCapture?k.captureNames:null)},S={on:function(c,a,b){b=b||{},c&&H.push({pattern:I(c,"g"+(K?"y":"")),handler:a,scope:b.scope||Q,trigger:b.trigger||null}),b.customFlags&&(B=M.replace.call(B+b.customFlags,N,""))},off:function(){throw new Error("extensibility must be installed before using addToken")}},E.addToken=S.off,E.cache=function(c,a){var b=c+"/"+(a||"");return L[b]||(L[b]=E(c,a))},E.escape=function(a){return M.replace.call(a,/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},E.exec=function(h,c,b,a){var g=I(c,"g"+(a&&K?"y":""),a===!1?"y":""),d;return g.lastIndex=b=b||0,d=G.exec.call(g,h),a&&d&&d.index!==b&&(d=null),c.global&&(c.lastIndex=d?g.lastIndex:0),d},E.forEach=function(k,b,c,a){for(var g=0,h=-1,d;d=E.exec(k,b,g);){c.call(a,d,++h,k,b),g=d.index+(d[0].length||1)}return a},E.globalize=function(a){return I(a,"g")},E.install=function(a){a=R(a),!P.natives&&a.natives&&j(!0),!P.extensibility&&a.extensibility&&U(!0)},E.isInstalled=function(a){return !!P[a]},E.isRegExp=function(a){return F(a,"regexp")},E.matchChain=function(c,a){return function b(l,d){for(var k=a[d].regex?a[d]:{regex:a[d]},h=[],g=function(e){h.push(k.backref?e[k.backref]||"":e[0])},i=0;i<l.length;++i){E.forEach(l[i],k.regex,g)}return d===a.length-1||!h.length?h:b(h,d+1)}([c],0)},E.replace=function(b,a,k,l){var n=E.isRegExp(a),g=a,d;return n?(l===J&&a.global&&(l="all"),g=I(a,l==="all"?"g":"",l==="all"?"":"g")):l==="all"&&(g=new RegExp(E.escape(String(a)),"g")),d=G.replace.call(String(b),g,k),n&&a.global&&(a.lastIndex=0),d},E.split=function(c,b,a){return G.split.call(c,b,a)},E.test=function(d,b,c,a){return !!E.exec(d,b,c,a)},E.uninstall=function(a){a=R(a),P.natives&&a.natives&&j(!1),P.extensibility&&a.extensibility&&U(!1)},E.union=function(d,k){var g=/(\()(?!\?)|\\([1-9]\d*)|\\[\s\S]|\[(?:[^\\\]]|\\[\s\S])*]/g,b=0,s,p,v=function(h,e,c){var f=p[b-s];if(e){if(++b,f){return"(?<"+f+">"}}else{if(c){return"\\"+(+c+s)}}return h},t=[],a,w;if(!(F(d,"array")&&d.length)){throw new TypeError("patterns must be a nonempty array")}for(w=0;w<d.length;++w){a=d[w],E.isRegExp(a)?(s=b,p=a.xregexp&&a.xregexp.captureNames||[],t.push(E(a.source).source.replace(g,v))):t.push(E.escape(a))}return E(t.join("|"),k)},E.version="2.0.0",G.exec=function(b){var c,d,g,h,a;if(this.global||(h=this.lastIndex),c=M.exec.apply(this,arguments),c){if(!m&&c.length>1&&V(c,"")>-1&&(g=new RegExp(this.source,M.replace.call(O(this),"g","")),M.replace.call(String(b).slice(c.index),g,function(){for(var e=1;e<arguments.length-2;++e){arguments[e]===J&&(c[e]=J)}})),this.xregexp&&this.xregexp.captureNames){for(a=1;a<c.length;++a){d=this.xregexp.captureNames[a-1],d&&(c[d]=c[a])}}this.global&&!c[0].length&&this.lastIndex>c.index&&(this.lastIndex=c.index)}return this.global||(this.lastIndex=h),c},G.test=function(a){return !!G.exec.call(this,a)},G.match=function(b){if(E.isRegExp(b)){if(b.global){var a=M.match.apply(this,arguments);return b.lastIndex=0,a}}else{b=new RegExp(b)}return G.exec.call(b,this)},G.replace=function(k,c){var g=E.isRegExp(k),a,d,b,i;return g?(k.xregexp&&(a=k.xregexp.captureNames),k.global||(i=k.lastIndex)):k+="",F(c,"function")?d=M.replace.call(String(this),k,function(){var f=arguments,e;if(a){for(f[0]=new String(f[0]),e=0;e<a.length;++e){a[e]&&(f[0][a[e]]=f[e+1])}}return g&&k.global&&(k.lastIndex=f[f.length-2]+f[0].length),c.apply(null,f)}):(b=String(this),d=M.replace.call(b,k,function(){var e=arguments;return M.replace.call(String(c),T,function(l,h,n){var o;if(h){if(o=+h,o<=e.length-3){return e[o]||""}if(o=a?V(a,h):-1,o<0){throw new SyntaxError("backreference to undefined group "+l)}return e[o+1]||""}if(n==="$"){return"$"}if(n==="&"||+n==0){return e[0]}if(n==="`"){return e[e.length-1].slice(0,e[e.length-2])}if(n==="'"){return e[e.length-1].slice(e[e.length-2]+e[0].length)}if(n=+n,!isNaN(n)){if(n>e.length-3){throw new SyntaxError("backreference to undefined group "+l)}return e[n]||""}throw new SyntaxError("invalid token "+l)})})),g&&(k.lastIndex=k.global?0:i),d},G.split=function(d,a){if(!E.isRegExp(d)){return M.split.apply(this,arguments)}var i=String(this),c=d.lastIndex,g=[],k=0,b;return a=(a===J?-1:a)>>>0,E.forEach(i,d,function(e){e.index+e[0].length>k&&(g.push(i.slice(k,e.index)),e.length>1&&e.index<i.length&&Array.prototype.push.apply(g,e.slice(1)),b=e[0].length,k=e.index+b)}),k===i.length?(!M.test.call(d,"")||b)&&g.push(""):g.push(i.slice(k)),d.lastIndex=c,g.length>a?g.slice(0,a):g},D=S.on,D(/\\([ABCE-RTUVXYZaeg-mopqyz]|c(?![A-Za-z])|u(?![\dA-Fa-f]{4})|x(?![\dA-Fa-f]{2}))/,function(b,a){if(b[1]==="B"&&a===Q){return b[0]}throw new SyntaxError("invalid escape "+b[0])},{scope:"all"}),D(/\[(\^?)]/,function(a){return a[1]?"[\\s\\S]":"\\b\\B"}),D(/(?:\(\?#[^)]*\))+/,function(a){return M.test.call(W,a.input.slice(a.index+a[0].length))?"":"(?:)"}),D(/\\k<([\w$]+)>/,function(c){var b=isNaN(c[1])?V(this.captureNames,c[1])+1:+c[1],a=c.index+c[0].length;if(!b||b>this.captureNames.length){throw new SyntaxError("backreference to undefined group "+c[0])}return"\\"+b+(a===c.input.length||isNaN(c.input.charAt(a))?"":"(?:)")}),D(/(?:\s+|#.*)+/,function(a){return M.test.call(W,a.input.slice(a.index+a[0].length))?"":"(?:)"},{trigger:function(){return this.hasFlag("x")},customFlags:"x"}),D(/\./,function(){return"[\\s\\S]"},{trigger:function(){return this.hasFlag("s")},customFlags:"s"}),D(/\(\?P?<([\w$]+)>/,function(a){if(!isNaN(a[1])){throw new SyntaxError("can't use integer as capture name "+a[0])}return this.captureNames.push(a[1]),this.hasNamedCapture=!0,"("}),D(/\\(\d+)/,function(b,a){if(!(a===Q&&/^[1-9]/.test(b[1])&&+b[1]<=this.captureNames.length)&&b[1]!=="0"){throw new SyntaxError("can't use octal escape or backreference to undefined group "+b[0])}return b[0]},{scope:"all"}),D(/\((?!\?)/,function(){return this.hasFlag("n")?"(?:":(this.captureNames.push(null),"(")},{customFlags:"n"}),typeof exports!="undefined"&&(exports.XRegExp=E),E}();